Description
===========

Have a massive Empire? Want to delegate power to a small number of
Kings? Annoyed by having to wait for everything to de-jure drift into
titles that don't represent the whole area?

Well, now you have a solution. High Kings!

What are High Kings?
--------------------

High Kings hold all of the territory in a de-jure Empire. Instead of
all the little Kingdoms there's one with the same name and flag as the
Empire title.

The High Kingdom remains de-jure part of the Empire they were created
from, but they can be de-jure drifted out into your primary Empire.

How do I make a High Kingdom?
-----------------------------

Either completely control all the de-jure lands of the Empire of your
Primary Title, or ensure a vassal of yours holds all the lands of
the Empire.

As a technical limit, you (or your vassal) must not hold any Kingdoms
belonging to an Empire outside your (or your vassal's) primary title's
Empire.

The decision will become visible after you (or your vassal) hold at
least two de-jure Kingdoms in the de-jure Empire of your (or your
vassal's) primary title.

There are no limits from rank, so you can make a High Kingdom for yourself
as a Count, Duke, King or Emperor, but you need to be an Emperor to make
a High Kingdom for a Vassal.

Installation Instructions
=========================

If you're installing from the Steam Workshop, this should all be automatic.

If not, you need to put the highkings directory extracted from the archive
in your Crusader Kings II mod directory, and copy the highkings.mod file
into the mod directory.

TODO
====

*   Consider how best to balance the decisions.

    Perhaps High Kingdom as King should have a prestige cost, and High
    Kingdoms as Emperor should require Imperial Administration.

*   Consider how to create Viceroyal High Kingdoms for Vassals.

    It's undocumented on ck2wiki.com, and there's no explicit announcement
    of how to do it in the ChangeLog, other than for history files.

    If there's no way to create the titles as Viceroyal, then I'll have to
    create the title in the scope of the Emperor and Viceroyally grant it.

*   Refactor the logic into character flags for potential High Kings,
    so the selection logic can be the same for yourself being eligible
    and your vassals being eligible.

    Triggered modifiers may be the most convenient way to do this, but
    there's no drop-in directory for them, see Feature request 4.

*   Refactor the logic into an event to create the High Kingdom, so the
    decisions can share logic for the effect.

Bugs
====

*   You can't create a High Kingdom if you hold Kingdoms outside the
    Empire of your primary title.

    If the creator of a High Kingdom holds other Kingdoms, then they may
    become de-jure the Empire of the new High Kingdom, and have the
    lands of the High Kingdom assigned to them.

    This is why I have put in the potentially arbitrary restriction.

    See feature request 1.

*   The old Kingdoms can still be created as Titular Kingdoms.

    See feature request 2.

*   Titular Kingdoms don't contribute towards when the decision appears.

    This may either be a bug or a feature, but I don't have the choice.

    See feature request 2.

*   Making a High Kingdom for a Duke vassal grants the de-jure lands,
    but in the process the Counts become directly your Vassal.

Feature Requests
================

1.  A way to obtain a reference to the newly created custom title.

    This isn't needed for the Charlemagne expansion because when going
    up in rank it automatically becomes your primary title.

    I needed to destroy the old Kingdoms and look through all the held
    Kingdoms, which would result in the lands of those Kingdoms going to
    the new High Kingdom, vassalising everyone in that de-jure Kingdom,
    leaving the Kingdom created and making it de-jure the Empire of the
    High Kingdom.

2.  Checking whether a title is active or changing the active status of
    a title requires it to be explicitly named.

    This is sufficient for base-game, as the events are tied to specific
    titles, but I need to be a lot more dynamic.

    To be able to handle this, I need to be able to pass a reference like
    `PREV` or `THIS` to `is_title_active` and `activate_title`.

3.  Allow the `empire` scope to be used on empire tier titles.

    I need two different decisions to handle making High Kingdom titles
    when I'm an Emperor or a King. If I could get an empire scope from
    an empire then the same logic would fall through.

4.  Allow drop-in directories for triggered_modifiers.txt

    I need a flag for eligibility for High Kingship, but it's annoying to
    have to trigger an event to add the flag and an event to remove it,
    and define the flag itself, so it would be convienient to be able
    to put all 3 in the same definition.
